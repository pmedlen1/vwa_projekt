{% extends "base.html" %}
{% block title %}{% if edit_user %}Upraviť používateľa{% else %}Nový používateľ{% endif %}{% endblock %}

{% block content %}
<div class="page">
  <div class="page__header">
    <div class="page__titles">
        <a href="{{ url_for('users_ui') }}" style="text-decoration:none; color: var(--muted); font-size: 0.9rem;">← Späť na zoznam</a>
        <h2 class="page__title">{% if edit_user %}Upraviť používateľa{% else %}Nový používateľ{% endif %}</h2>
    </div>
  </div>

  <div class="card form-card">
    <form method="post" action="{% if edit_user %}{{ url_for('edit_user_post', user_id=edit_user.id) }}{% else %}{{ url_for('create_user_post') }}{% endif %}">

      {% if errors %}
      <div style="background: #fee2e2; color: #991b1b; padding: 1rem; border-radius: 0.5rem; margin-bottom: 1.5rem;">
        {{ errors }}
      </div>
      {% endif %}

      <h3 style="margin-bottom:0.5rem; font-size:1rem; color: var(--accent-dark);">Prihlasovacie údaje</h3>

      {% if not edit_user %}
      <div style="display:flex; gap:1rem; flex-wrap:wrap;">
          <label style="flex:1;">
            Username (Prihlasovacie meno)
            <input type="text" name="username" required placeholder="napr. jmrkvicka">
          </label>
          <label style="flex:1;">
            Heslo
            <input type="password" name="password" required placeholder="********">
          </label>
      </div>
      {% else %}
      <div style="margin-bottom: 1rem;">
          <label style="display:block; font-size: 0.85rem; font-weight: 600; color: var(--accent-dark);">Username</label>
          <div style="padding: 0.65rem 0.85rem; background: #f5f5f5; border-radius: 0.75rem; margin-top: 0.35rem; color: #555;">
              {{ edit_user.username }}
          </div>
          <small style="color: var(--muted); margin-top: 0.2rem; display: block;">Heslo nie je možné zmeniť v tomto formulári.</small>
      </div>
      {% endif %}

      <div style="margin-top: 1rem;">
        <label>
            Rola (Oprávnenia)
            <select name="role" required style="width: 100%; padding: 0.75rem; border-radius: 0.75rem; border: 1px solid #ddd; background: #fff; font-family: inherit;">
                <option value="player" {% if edit_user and edit_user.role == 'player' %}selected{% endif %}>Hráč (Základný prístup)</option>
                <option value="coach" {% if edit_user and edit_user.role == 'coach' %}selected{% endif %}>Tréner (Správa tímu)</option>
                <option value="admin" {% if edit_user and edit_user.role == 'admin' %}selected{% endif %}>Admin (Plný prístup)</option>
            </select>
        </label>
      </div>

      <h3 style="margin-top:1.5rem; margin-bottom:0.5rem; font-size:1rem; color: var(--accent-dark);">Osobné údaje</h3>

      <div style="display:flex; gap:1rem; flex-wrap:wrap;">
          <label style="flex:1;">
            Meno
            <input type="text" name="first_name" value="{{ edit_user.first_name if edit_user and edit_user.first_name else '' }}" placeholder="Meno">
          </label>
          <label style="flex:1;">
            Priezvisko
            <input type="text" name="last_name" value="{{ edit_user.last_name if edit_user and edit_user.last_name else '' }}" placeholder="Priezvisko">
          </label>
      </div>

      <div style="display:flex; gap:1rem; flex-wrap:wrap; margin-top: 1rem;">
          <label style="flex:1;">
            Pozícia (len pre hráčov)
            <input type="text" name="position" value="{{ edit_user.position if edit_user and edit_user.position else '' }}" placeholder="napr. Útočník">
          </label>
          <label style="flex:1;">
            Dátum narodenia
            <input type="date" name="birth_date" value="{{ edit_user.birth_date if edit_user and edit_user.birth_date else '' }}">
          </label>
      </div>

      <div style="margin-top:2rem; display:flex; gap:1rem;">
          <button type="submit" class="button">Uložiť</button>
          <a href="{{ url_for('users_ui') }}" class="button" style="background: var(--muted); text-decoration: none;">Zrušiť</a>
      </div>

    </form>
  </div>
</div>
{% endblock %}